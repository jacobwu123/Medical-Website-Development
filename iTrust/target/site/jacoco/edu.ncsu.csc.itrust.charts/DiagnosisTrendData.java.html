<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DiagnosisTrendData.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">iTrust</a> &gt; <a href="index.source.html" class="el_package">edu.ncsu.csc.itrust.charts</a> &gt; <span class="el_source">DiagnosisTrendData.java</span></div><h1>DiagnosisTrendData.java</h1><pre class="source lang-java linenums">package edu.ncsu.csc.itrust.charts;

import java.io.Externalizable;
import java.io.IOException;
import java.io.ObjectInput;
import java.io.ObjectOutput;
import java.io.Serializable;
import java.util.Date;
import java.util.Map;

import org.jfree.data.category.CategoryDataset;
import org.jfree.data.category.DefaultCategoryDataset;

import de.laures.cewolf.DatasetProduceException;
import de.laures.cewolf.DatasetProducer;
import de.laures.cewolf.links.CategoryItemLinkGenerator;
import de.laures.cewolf.tooltips.CategoryToolTipGenerator;
import edu.ncsu.csc.itrust.beans.DiagnosisStatisticsBean;

/**
 * DiagnosisTrendData
 */
<span class="fc" id="L23">public class DiagnosisTrendData implements DatasetProducer, Externalizable, CategoryToolTipGenerator, CategoryItemLinkGenerator, Serializable {</span>
	
	/**serialVersionUID*/
	private static final long serialVersionUID = -4675064587294163834L;
		
	private String[] seriesName;

	// Initialize the values for each week to 0
	private int[] values;
	
	// List of the beans for the diagnosis statistics 
<span class="fc" id="L34">	private DiagnosisStatisticsBean dsBean = new DiagnosisStatisticsBean();</span>
	
<span class="fc" id="L36">	@SuppressWarnings(&quot;unused&quot;)</span>
	private DiagnosisStatisticsBean avgBean = new DiagnosisStatisticsBean();
	    
	// Name of the diagnosis being searched for
	private String diagnosisName;
	
<span class="fc" id="L42">	private Boolean epidemic = false;</span>

	/**
	 * hasData
	 * @return has date
	 */
	public boolean hasData() {
			
<span class="pc bpc" id="L50" title="1 of 2 branches missed.">		if ( dsBean != null ) {</span>
			
<span class="fc" id="L52">	    	return true;</span>
	    		
	    }

<span class="nc" id="L56">	  	return false;</span>
	    
	}
	 
	 /**
	     * Called from the JSP to initialize the list of HealthRecords needed
	     * to produce the desired chart.
	     * 
	     * @param DiagnosisBean DiagnosisBean
	     * @param name Type of data that is being graphed (originally Height, Weight, and BMI).
	     */
	public void initializeDiagnosisStatistics ( DiagnosisStatisticsBean DiagnosisBean, String name ) {
		
<span class="fc" id="L69">		this.dsBean = DiagnosisBean;</span>
<span class="fc" id="L70">	    this.diagnosisName = name;</span>
	    
<span class="fc" id="L72">	    values = new int[2];</span>
<span class="fc" id="L73">	    values[0] = (int) dsBean.getZipStats();</span>
<span class="fc" id="L74">	    values[1] = (int) dsBean.getRegionStats();</span>
	    	
<span class="fc" id="L76">	}</span>
	
	/**
	 * initializeAvgDiagnosisStatistics
	 * @param avgBean agvBean
	 * @param dsBean dsBean
	 * @param name name
	 */
	public void initializeAvgDiagnosisStatistics( DiagnosisStatisticsBean avgBean, DiagnosisStatisticsBean dsBean, String name ) {
		
<span class="fc" id="L86">		this.dsBean = dsBean;</span>
<span class="fc" id="L87">		this.avgBean = avgBean;</span>
<span class="fc" id="L88">		this.diagnosisName = name;</span>
<span class="fc" id="L89">		this.epidemic = true;</span>
		
<span class="fc" id="L91">		values = new int[4];</span>
<span class="fc" id="L92">		values[0] = (int) dsBean.getZipStats();</span>
<span class="fc" id="L93">		values[1] = (int) avgBean.getZipStats();</span>
<span class="fc" id="L94">		values[2] = (int) dsBean.getRegionStats();</span>
<span class="fc" id="L95">		values[3] = (int) avgBean.getRegionStats();</span>
		
<span class="fc" id="L97">	}</span>
	
	    /**
	     * This method parses the list of DiagnosisStatistics Beans to initialize the
	     * chart data set.
	     * @param params params
	     * @return A data set containing information to be graphed
	     * @throws DatasetProduceException
	     */
		public Object produceDataset(@SuppressWarnings(&quot;rawtypes&quot;) Map params) throws DatasetProduceException {
	    	// The DefaultCategoryDataset is used for bar charts.
	    	// This data set class may change based on the type of chart you wish to produce.
<span class="fc" id="L109">	        DefaultCategoryDataset dataset = new DefaultCategoryDataset(){</span>
				/**
				 * 
				 */
				private static final long serialVersionUID = 1L;

				
	        };
	        
<span class="fc bfc" id="L118" title="All 2 branches covered.">	        if ( epidemic == false ) {</span>
	        	
<span class="fc" id="L120">	        	seriesName = new String[2];</span>
	        	
<span class="fc" id="L122">	        	dataset.addValue(values[0], diagnosisName, &quot;Zipcode Cases&quot;);</span>
<span class="fc" id="L123">	        	dataset.addValue(values[1], diagnosisName, &quot;Region Cases&quot;);</span>
<span class="fc" id="L124">	        	seriesName[0] = &quot;Zipcode Case&quot;;</span>
<span class="fc" id="L125">	        	seriesName[1] = &quot;Region Cases&quot;;</span>
	        	
	        	
<span class="pc bpc" id="L128" title="1 of 2 branches missed.">	        } else if ( epidemic == true ) {</span>
	        	
<span class="fc" id="L130">	        	seriesName = new String[4];</span>
	        	
<span class="fc" id="L132">	        	dataset.addValue(values[0], diagnosisName, &quot;Current Week Zipcode Cases&quot;);</span>
<span class="fc" id="L133">	        	dataset.addValue(values[1], diagnosisName, &quot;Average Prior Zipcode Cases&quot;);</span>
<span class="fc" id="L134">	        	dataset.addValue(values[2], diagnosisName, &quot;Current Week Region Cases&quot;);</span>
<span class="fc" id="L135">	        	dataset.addValue(values[3], diagnosisName, &quot;Average Prior Region Cases&quot;);</span>
	        	 	
<span class="fc" id="L137">	        	seriesName[0] = &quot;Current Week Zipcode Cases&quot;;</span>
<span class="fc" id="L138">	        	seriesName[1] = &quot;Average Prior Zipcode Cases&quot;;</span>
<span class="fc" id="L139">	        	seriesName[2] = &quot;Current Week Region Cases&quot;;</span>
<span class="fc" id="L140">	        	seriesName[3] = &quot;Average Prior Region Cases&quot;;</span>
	        	
	        }

<span class="fc" id="L144">	        return dataset;</span>
	    }

	    /**
	     * This producer's data is invalidated after 5 seconds. By this method the
	     * producer can influence Cewolf's caching behavior the way it wants to.
	     * @param params params
	     * @param since date since
	     * @return time
	     */
		@SuppressWarnings(&quot;rawtypes&quot;)
		public boolean hasExpired(Map params, Date since) {		
<span class="nc bnc" id="L156" title="All 2 branches missed.">			return (System.currentTimeMillis() - since.getTime())  &gt; 5000;</span>
		}

		/**
		 * getProducerId
		 * @return A unique ID for this DatasetProducer
		 */
		public String getProducerId() {
<span class="nc" id="L164">			return &quot;DiagnosisTrendData DatasetProducer&quot;;</span>
		}

	    /**
	     * generateLink
	     * @param data data
	     * @param series series
	     * @param category category
	     * @return A link target for a special data item.
	     */
	    public String generateLink(Object data, int series, Object category) {
<span class="nc" id="L175">	        return seriesName[series];</span>
	    }
	    
		

		/**
		 * generateToolTip
		 * @param arg0 arg0
		 * @param series series
		 * @param arg2 arg2
		 * @return series name
		 * @see org.jfree.chart.tooltips.CategoryToolTipGenerator#generateToolTip(CategoryDataset, int, int)
		 */
		public String generateToolTip(CategoryDataset arg0, int series, int arg2) {
<span class="nc" id="L189">			return seriesName[series];</span>
		}

		/**
		 * readExternal
		 * @param in in
		 * @throws IOException
		 * @throws ClassNotFoundException
		 */
		public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException {
			// TODO Auto-generated method stub
			
<span class="nc" id="L201">		}</span>

		/**
		 * writeExternal
		 * @param out out
		 * @throws IOException
		 */
		public void writeExternal(ObjectOutput out) throws IOException {
			// TODO Auto-generated method stub
			
<span class="nc" id="L211">		}</span>
		
}
	


</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>